# Wiktoria Byra, zadanie 4 lista 2 laboratorium Obliczenia naukowe

using Polynomials

# obliczanie wielomianu Wilkinsona
function p(x)
    return (x-20)*(x-19)*(x-18)*(x-17)*(x-16)*(x-15)*(x-14)*(x-13)*(x-12)*(x-11)*(x-10)*(x-9)*(x-8)*(x-7)*(x-6)*(x-5)*(x-4)*(x-3)*(x-2)*(x-1)
end

# obliczanie wielomianu Wilkinsona z postaci naturalnej
function P(x)
    return (x^20-210*x^19+20615*x^18-1256850*x^17+53327946*x^16-1672280820*x^15+40171771630*x^14-756111184500*x^13+11310276995381*x^12-135585182899530*x^11+1307535010540395*x^10-10142299865511450*x^9+63030812099294896*x^8-311333643161390640*x^7+1206647803780373360*x^6-3599979517947607200*x^5+8037811822645051776*x^4-12870931245150988800*x^3+13803759753640704000*x^2-8752948036761600000*x+2432902008176640000)
end

# obliczanie wielomianu Wilkinsona z modyfkacją drugiego współczynnika
function P_eks(x)
    return (x^20+(-210- 2^-23)*x^19+20615*x^18-1256850*x^17+53327946*x^16-1672280820*x^15+40171771630*x^14-756111184500*x^13+11310276995381*x^12-135585182899530*x^11+1307535010540395*x^10-10142299865511450*x^9+63030812099294896*x^8-311333643161390640*x^7+1206647803780373360*x^6-3599979517947607200*x^5+8037811822645051776*x^4-12870931245150988800*x^3+13803759753640704000*x^2-8752948036761600000*x+2432902008176640000)
end

function wilkinson()
    # wspołczynniki wielomianu Wilkinsona
    wspol=[1, -210.0, 20615.0,-1256850.0,
      53327946.0,-1672280820.0, 40171771630.0, -756111184500.0,          
      11310276995381.0, -135585182899530.0,
      1307535010540395.0,     -10142299865511450.0,
      63030812099294896.0,     -311333643161390640.0,
      1206647803780373360.0,     -3599979517947607200.0,
      8037811822645051776.0,      -12870931245150988800.0,
      13803759753640704000.0,      -8752948036761600000.0,
      2432902008176640000.0]
    z = roots(Polynomial(reverse(wspol))) # miejsca zerowe wielomianu
    k = 20
    for zk in z
        println("zk = ", zk, " p(zk) = ", abs(p(zk)), " P(zk) = ", abs(P(zk)), "|zk-k| = ", abs(zk - k))
        k -= 1
    end
end

function eksperyment()
    wspol=[1, -210.0 - 2^-23, 20615.0,-1256850.0,
      53327946.0,-1672280820.0, 40171771630.0, -756111184500.0,          
      11310276995381.0, -135585182899530.0,
      1307535010540395.0,     -10142299865511450.0,
      63030812099294896.0,     -311333643161390640.0,
      1206647803780373360.0,     -3599979517947607200.0,
      8037811822645051776.0,      -12870931245150988800.0,
      13803759753640704000.0,      -8752948036761600000.0,
      2432902008176640000.0]
    z = roots(Polynomial(reverse(wspol)))
    k = 20
    for zk in z
        println("zk = ", zk, " p(zk) = ", abs(p(zk)), " P(zk) = ", abs(P_eks(zk)), "|zk-k| = ", abs(zk - k))
        k -= 1
    end
end

    
